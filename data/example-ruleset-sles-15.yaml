---
security_baseline::baseline_version: '1.0.0'
security_baseline::debug: false
security_baseline::log_info: true
security_baseline::auditd_suid_include:
  - /usr
security_baseline::update_postrun_command: true
security_baseline::reporting_type: fact
security_baseline::logfile: /opt/puppetlabs/facter/facts.d/security_baseline_findings.yaml
security_baseline::auditd_rules_file: /etc/audit/rules.d/sec_baseline_auditd.rules
security_baseline::auditd_rules_fact_file: /opt/puppetlabs/facter/facts.d/security_baseline_auditd.yaml
security_baseline::reboot: false
security_baseline::reboot_timeout: 60
security_baseline::rules:
  '1.1.1.1':
    rulename: 'squashfs'
    active: true
    scored: true
    level: 1
    description: 'The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems (similar to cramfs ). A squashfs image can be used without having to first decompress the image.'
    enforce: true
    class: '::security_baseline::rules::common::sec_squashfs'
    check:
      fact_hash: security_baseline
      fact_name: 
        - kernel_modules
        - squashfs
      fact_value: false
    message: 'Rule 1.1.1.1. Squashfs kernel module should not be available.'
    log_level: 'warning'
  '1.1.1.2':
    rulename: 'udf'
    active: true
    scored: true
    level: 1
    description: 'The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats.'
    enforce: true
    class: '::security_baseline::rules::common::sec_udf'
    check:
      fact_hash: security_baseline
      fact_name: 
        - kernel_modules
        - udf
      fact_value: false
    message: 'Rule 1.1.1.2. Udf kernel module should not be available.'
    log_level: 'warning'
  '1.1.1.3':
    rulename: 'vfat'
    active: true
    scored: true
    level: 1
    description: 'The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.'
    enforce: false
    class: '::security_baseline::rules::sles::sec_fat'
    check:
      fact_hash: security_baseline
      fact_name: 
        - kernel_modules
        - vfat
      fact_value: false
    message: 'Rule 1.1.1.3. Fat kernel modules should not be available.'
    log_level: 'warning'
  '1.1.2':
    rulename: 'tmp_partition'
    active: true
    scored: true
    level: 2
    description: 'The /tmp directory is a world-writable directory used for temporary storage by all users and some applications.'
    enforce: true
    class: '::security_baseline::rules::common::sec_tmp_partition'
    check:
      fact_hash: security_baseline
      fact_name:
        - partitions
        - tmp
        - partition
      fact_value: '/tmp'
    message: 'Rule 1.1.2. Have a separate directory for /tmp.'
    log_level: 'warning'
  '1.1.3':
    rulename: 'tmp_noexec'
    active: true
    scored: true
    level: 1
    description: 'The noexec mount option specifies that the /tmp filesystem cannot contain executable binaries.'
    enforce: true
    class: '::security_baseline::rules::common::sec_tmp_noexec'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - tmp
        - noexec
      fact_value: true
    message: 'Rule 1.1.3. /tmp should be mounted with noexec option.'
    log_level: 'warning'
  '1.1.4':
    rulename: 'tmp_nodev'
    active: true
    scored: true
    level: 1
    description: 'The nodev mount option specifies that the /tmp filesystem cannot contain special devices.'
    enforce: true
    class: '::security_baseline::rules::common::sec_tmp_nodev'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - tmp
        - nodev
      fact_value: true
    message: 'Rule 1.1.4. /tmp should be mounted with nodev option.'
    log_level: 'warning'
  '1.1.5':
    rulename: 'tmp_nosuid'
    active: true
    scored: true
    level: 1
    description: 'The nosuid mount option specifies that the /tmp filesystem cannot contain suid files.'
    enforce: true
    class: '::security_baseline::rules::common::sec_tmp_nosuid'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - tmp
        - nosuid
      fact_value: true
    message: 'Rule 1.1.5. /tmp should be mounted with nosuid option.'
    log_level: 'warning'
  '1.1.6':
    rulename: 'dev_shm_partition'
    active: true
    scored: true
    level: 2
    description: '/dev/shm is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access. If /dev/shm is not configured, tmpfs will be mounted to /dev/shm by systemd.'
    enforce: true
    class: '::security_baseline::rules::common::sec_dev_shm_partition'
    check:
      fact_hash: security_baseline
      fact_name:
        - partitions
        - shm
        - partition
      fact_value: '/dev/shm'
    message: 'Rule 1.1.6. Have /dev/shm configured in fstab.'
    log_level: 'warning'
  '1.1.7':
    rulename: 'dev_shm_noexec'
    active: true
    scored: true
    level: 1
    description: 'The noexec mount option specifies that the /dev/shm filesystem cannot contain executable binaries.'
    enforce: true
    class: '::security_baseline::rules::common::sec_dev_shm_noexec'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - shm
        - noexec
      fact_value: true
    message: 'Rule 1.1.7. /dev/shm should be mounted with noexec option.'
    log_level: 'warning'
  '1.1.8':
    rulename: 'dev_shm_nodev'
    active: true
    scored: true
    level: 1
    description: 'The nodev mount option specifies that the /dev/shm filesystem cannot contain special devices.'
    enforce: true
    class: '::security_baseline::rules::common::sec_dev_shm_nodev'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - shm
        - nodev
      fact_value: true
    message: 'Rule 1.1.8. /dev/shm should be mounted with nodev option.'
    log_level: 'warning'
  '1.1.9':
    rulename: 'dev_shm_nosuid'
    active: true
    scored: true
    level: 1
    description: 'The nosuid mount option specifies that the /dev/shm filesystem cannot contain suid files.'
    enforce: true
    class: '::security_baseline::rules::common::sec_dev_shm_nosuid'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - shm
        - nosuid
      fact_value: true
    message: 'Rule 1.1.9. /dev/shm should be mounted with nosuid option.'
    log_level: 'warning'
  '1.1.10':
    rulename: 'var_partition'
    active: true
    scored: true
    level: 2
    description: 'The /var directory is used by daemons and other system services to temporarily store dynamic data. Some directories created by these processes may be world-writable.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_partition'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var
        - partition
      fact_value: '/var'
    message: 'Rule 1.1.10. Have a separate directory for /var.'
    log_level: 'warning'
  '1.1.11':
    rulename: 'var_tmp_partition'
    active: true
    scored: true
    level: 2
    description: 'The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_tmp_partition'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_tmp
        - partition
      fact_value: '/var/tmp'
    message: 'Rule 1.1.11. Have a separate directory for /var/tmp.'
    log_level: 'warning'
  '1.1.12':
    rulename: 'var_tmp_noexec'
    active: true
    scored: true
    level: 1
    description: 'The noexec mount option specifies that the /var/tmp filesystem cannot contain executable binaries.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_tmp_noexec'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_tmp
        - noexec
      fact_value: true
    message: 'Rule 1.1.12. /var/tmp should be mounted with noexec option.'
    log_level: 'warning'
  '1.1.13':
    rulename: 'var_tmp_nodev'
    active: true
    scored: true
    level: 1
    description: 'The nodev mount option specifies that the /var/tmp filesystem cannot contain special devices.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_tmp_nodev'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_tmp
        - nodev
      fact_value: true
    message: 'Rule 1.1.13. /var/tmp should be mounted with nodev option.'
    log_level: 'warning'
  '1.1.14':
    rulename: 'var_tmp_nosuid'
    active: true
    scored: true
    level: 1
    description: 'The nosuid mount option specifies that the /var/tmp filesystem cannot contain suid files.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_tmp_nosuid'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_tmp
        - nosuid
      fact_value: true
    message: 'Rule 1.1.14. /var/tmp should be mounted with nosuid option.'
    log_level: 'warning'
  '1.1.15':
    rulename: 'var_log_partition'
    active: true
    scored: true
    level: 2
    description: 'The /var/log directory is used by system services to store log data.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_log_partition'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_log
        - partition
      fact_value: '/var/log'
    message: 'Rule 1.1.15. Have a separate directory for /var/log.'
    log_level: 'warning'
  '1.1.16':
    rulename: 'var_log_audit_partition'
    active: true
    scored: true
    level: 2
    description: 'The auditing daemon, auditd , stores log data in the /var/log/audit directory.'
    enforce: true
    class: '::security_baseline::rules::common::sec_var_log_audit_partition'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - var_log_audit
        - partition
      fact_value: '/var/log/audit'
    message: 'Rule 1.1.16. Have a separate directory for /var/log/audit.'
    log_level: 'warning'
  '1.1.17':
    rulename: 'home_partition'
    active: true
    scored: true
    level: 2
    description: 'The /home directory is used to support disk storage needs of local users.'
    enforce: true
    class: '::security_baseline::rules::common::sec_home_partition'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - home
        - partition
      fact_value: '/home'
    message: 'Rule 1.1.17. Have a separate directory for /home.'
    log_level: 'warning'
  '1.1.18':
    rulename: 'home_nodev'
    active: true
    scored: true
    level: 1
    description: 'The nodev mount option specifies that the /home filesystem cannot contain special devices.'
    enforce: true
    class: '::security_baseline::rules::common::sec_home_nodev'
    check:
      fact_hash: security_baseline
      fact_name: 
        - partitions
        - home
        - nodev
      fact_value: true
    message: 'Rule 1.1.18. /home should be mounted with nodev option.'
    log_level: 'warning'
  '1.1.19':
    rulename: 'removable_noexec'
    active: true
    scored: false
    level: 1
    description: 'The noexec mount option specifies that the filesystem cannot contain executable binaries.'
    enforce: true
    class: '::security_baseline::rules::common::sec_noexec_removable'
    check:
      fact_hash: security_baseline
      fact_name: ''
      fact_value: ''
    message: 'Rule 1.1.19.Removable media should be mounted with the noexec option.'
    log_level: 'warning'
  '1.1.20':
    rulename: 'removable_nodev'
    active: true
    scored: false
    level: 1
    description: 'The nodev mount option specifies that the filesystem cannot contain special devices.'
    enforce: true
    class: '::security_baseline::rules::common::sec_nodev_removable'
    check:
      fact_hash: security_baseline
      fact_name: ''
      fact_value: ''
    message: 'Rule 1.1.20. Removable media should be mounted with the nodev option.'
    log_level: 'warning'
  '1.1.21':
    rulename: 'removable_nosuid'
    active: true
    scored: false
    level: 1
    description: 'The nosuid mount option specifies that the filesystem cannot contain setuid files.'
    enforce: true
    class: '::security_baseline::rules::common::sec_nosuid_removable'
    check:
      fact_hash: security_baseline
      fact_name: ''
      fact_value: ''
    message: 'Rule 1.1.21. Removable media should be mounted with the nonosuiddev option.'
    log_level: 'warning'
  '1.1.22':
    rulename: 'sticky_ww'
    active: true
    scored: true
    level: 1
    description: 'Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.'
    enforce: true
    class: '::security_baseline::rules::common::sec_sticky_world_writeable'
    check:
      fact_hash: security_baseline
      fact_name: sticky_ww
      fact_value: 'none'
    message: 'Rule 1.1.22. All world writable directories should have sticky bit set.'
    log_level: 'warning'
  '1.1.23':
    rulename: 'automounting'
    active: true
    scored: true
    level: 1
    description: 'autofs allows automatic mounting of devices, typically including CD/DVDs and USB drives.'
    enforce: true
    class: '::security_baseline::rules::common::sec_automounting'
    check:
      fact_hash: security_baseline
      fact_name: 
        - services_enabled
        - srv_autofs
      fact_value: 'disabled'
    message: 'Rule 1.1.23. Automounting should be disabled.'
    log_level: 'warning'
  '1.2.1':
    rulename: 'zypper_gpg_keys'
    active: true
    scored: false
    level: 1
    description: 'Most packages managers implement GPG key signing to verify package integrity during installation.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_zypper_gpg_keys'
    check:
      fact_hash: security_baseline
      fact_name: 
        - apt_gpg_keys_config
      fact_value: true
    message: 'Rule 1.2.1. Zypper GPG keys should be configured.'
    log_level: 'warning'
  '1.2.2':
    rulename: 'zypper_repos'
    active: true
    scored: false
    level: 1
    description: 'Systems need to have package manager repositories configured to ensure they receive the latest patches and updates.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_zypper_repolist'
    check:
      fact_hash: security_baseline
      fact_name: 
        - zypper
        - repolist_config
      fact_value: true
    message: 'Rule 1.2.2. Zypper repositories should be configured.'
    log_level: 'warning'
  '1.2.3':
    rulename: 'zypper_gpg_keys'
    active: true
    scored: false
    level: 1
    description: 'The gpgcheck option, found in the main section of the /etc/zypp/zypp.conf and individual /etc/zypp/repos.d/*.repo files determines if an RPM packages signature is checked prior to its installation.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_zypper_gpgcheck'
    check:
      fact_hash: security_baseline
      fact_name: 
        - zypper
        - gpgcheck
      fact_value: true
    message: 'Rule 1.2.3. Zypper GPG check should be configured.'
    log_level: 'warning'
  '1.3.1':
    rulename: 'sudo-package'
    active: true
    scored: true
    level: 1
    description: 'sudo allows a permitted user to execute a command as the superuser or another user, as specified by the security policy. The invoking users real (not effective) user ID is used to determine the user name with which to query the security policy.'
    enforce: true
    class: '::security_baseline::rules::common::sec_sudo_package'
    check:
      fact_hash: security_baseline
      fact_name: 
        - packages_installed
        - sudo
      fact_value: true
    message: 'Rule 1.3.1. The sudo package should be installed.'
    log_level: 'warning'
  '1.3.2':
    rulename: 'sudo-use-pty'
    active: true
    scored: true
    level: 1
    description: 'sudo can be configured to run only from a psuedo-pty.'
    enforce: true
    class: '::security_baseline::rules::common::sec_sudo_use_pty'
    check:
      fact_hash: security_baseline
      fact_name: 
        - sudo
        - use_pty
      fact_value: used
    message: 'Rule 1.3.2. sudo should be configured to use a pty.'
    log_level: 'warning'
  '1.3.3':
    rulename: 'sudo-logfile'
    active: true
    scored: true
    level: 1
    description: 'sudo can use a custom log file.'
    enforce: true
    class: '::security_baseline::rules::common::sec_sudo_logfile'
    check:
      fact_hash: security_baseline
      fact_name: 
        - sudo
        - logfile
      fact_value: configured
    message: 'Rule 1.3.3. sudo should be configured to write a logfile.'
    log_level: 'warning'
  '1.4.1':
    rulename: 'aide'
    active: true
    scored: true
    level: 1
    description: 'AIDE takes a snapshot of filesystem state including modification times, permissions, and file hashes which can then be used to compare against the current state of the filesystem to detect modifications to the system.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_aide'
    check:
      fact_hash: security_baseline
      fact_name: 
        - aide
        - status
      fact_value: installed
    message: 'Rule 1.4.1. aide should be disabled.'
    log_level: 'warning'
  '1.4.2':
    rulename: 'aide-cron'
    active: true
    scored: true
    level: 1
    description: 'Periodic checking of the filesystem integrity is needed to detect changes to the filesystem.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_aide_cron'
    check:
      fact_hash: security_baseline
      fact_name: 
        - aide
        - cron
      fact_value: '0 5 * * * root /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check'
    message: Rule 1.4.2. aide cronjob should be setup.'
    log_level: 'warning'
  '1.5.1':
    rulename: 'grub_passwd'
    active: true
    description: 'Setting the boot loader password will require that anyone rebooting the system must enter a password before being able to set command line boot parameters.'
    enforce: true
    scored: true
    level: 1
    class: '::security_baseline::rules::common::sec_grub_passwd'
    check:
      fact_hash: security_baseline
      fact_name: 
        - grub
        - grub_passwd
      fact_value: true
    message: 'Rule 1.5.1. A Grub password should be set.'
    log_level: 'warning'
  '1.5.2':
    rulename: 'grub2'
    active: true
    scored: true
    level: 1
    description: 'The grub configuration file contains information on boot settings and passwords for unlocking boot options. The grub configuration is usually located at /boot/grub2/grub.cfg and linked as /etc/grub2.cfg. Additional settings can be found in the /boot/grub2/user.cfg file.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_grub'
    check:
      fact_hash: security_baseline
      fact_name:
        - grub
        - grub.cfg
        - combined
      fact_value: '0-0-384'
    message: 'Not compliant with rule 1.5.2. permissions not set accordingly for bootloader config.'
    log_level: 'warning'
  '1.5.3':
    rulename: 'single_user_mode'
    active: true
    scored: true
    level: 1
    description: 'Single user mode (rescue mode) is used for recovery when the system detects an issue during boot or by manual selection from the bootloader.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_single_user_mode'
    check:
      fact_hash: security_baseline
      fact_name: 
        - single_user_mode
        - status
      fact_value: true
    message: 'Rule 1.5.3. /sbin/sulogin should be used propperly for rescue mode.'
    log_level: 'warning'
  '1.6.1':
    rulename: 'core_dumps'
    active: true
    scored: true
    level: 1
    description: 'A core dump is the memory of an executable program. It is generally used to determine why a program aborted. It can also be used to glean confidential information from a core file. The system provides the ability to set a soft limit for core dumps, but this can be overridden by the user.'
    enforce: true
    class: '::security_baseline::rules::common::sec_core_dump'
    check:
      fact_hash: security_baseline
      fact_name:
        - coredumps
        - status
      fact_value: true
    message: 'Rule 1.6.1. Core dumps should be restricted.'
    log_level: 'warning'
  '1.6.2':
    rulename: 'nx_protection'
    active: true
    scored: false
    level: 1
    description: 'Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called No Execute (NX), while on Intel processors it is called Execute Disable (XD). This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature.'
    enforce: true
    class: '::security_baseline::rules::common::sec_nx_support'
    check:
      fact_hash: security_baseline
      fact_name:
        - nx
      fact_value: protected
    message: 'Rule 1.6.2. XD/NX support should be enabled.'
    log_level: 'warning'
  '1.6.3':
    rulename: 'kernel_aslr'
    active: true
    scored: true
    level: 1
    description: 'Address space layout randomization (ASLR) is an exploit mitigation technique which randomly arranges the address space of key data areas of a process.'
    enforce: true
    class: '::security_baseline::rules::common::sec_kernel_aslr'
    check:
      fact_hash: security_baseline
      fact_name: 
        - sysctl
        - kernel.randomize_va_space
      fact_value: '2'
    message: 'Rule 1.6.3. Kernel address space randomization should be enabled.'
    log_level: 'warning'
  '1.6.4':
    rulename: 'prelink'
    active: true
    scored: true
    level: 1
    description: 'prelinkis a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases.'
    enforce: true
    class: '::security_baseline::rules::sles::sec_prelink'
    check:
      fact_hash: security_baseline
      fact_name: 
        - packages_installed
        - prelink
      fact_value: false
    message: 'Rule 1.6.4. prelink package should not be installed.'
    log_level: 'warning'
